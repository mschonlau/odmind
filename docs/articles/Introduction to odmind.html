<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction to odmind â€¢ odmind</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to odmind">
<meta property="og:description" content="odmind">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">odmind</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction%20to%20odmind.html">An introduction to odmind</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mschonlau/odmind/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction%20to%20odmind_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An introduction to odmind</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mschonlau/odmind/blob/master/vignettes/Introduction%20to%20odmind.Rmd"><code>vignettes/Introduction to odmind.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction to odmind.Rmd</code></div>

    </div>

    
    
<p>This package consists of several functions which allow you to calculate origin-destination matrices based on the <em>OpenStreetMap</em> road network using the <a href="https://github.com/GIScience/openrouteservice-r">openrouteservice package</a>. The core functions build upon that and allow you to <strong>calculate accessibility indicators</strong> and <strong>aggregate indicators</strong> to spatial areas of interest.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load the package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mschonlau/odmind">odmind</a></span><span class="op">)</span></code></pre></div>
<hr>
<div id="step-0---explore-included-data-optional" class="section level2">
<h2 class="hasAnchor">
<a href="#step-0---explore-included-data-optional" class="anchor"></a>Step 0 - Explore included data <em>(optional)</em>
</h2>
<p>For visualization purposes a dataset with precalculated results and a <code>sf</code> of geometry type <code>POLYGON</code> is provided.</p>
<div id="testdata---odm-object-list" class="section level3">
<h3 class="hasAnchor">
<a href="#testdata---odm-object-list" class="anchor"></a>testdata - odm-object (list)</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the package data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"testdata"</span><span class="op">)</span>
<span class="co"># Basic information about the odm-list object</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Length</th>
<th align="left">Class</th>
<th align="left">Mode</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">distance</td>
<td align="left">32600</td>
<td align="left">-none-</td>
<td align="left">numeric</td>
</tr>
<tr class="even">
<td align="left">duration</td>
<td align="left">32600</td>
<td align="left">-none-</td>
<td align="left">numeric</td>
</tr>
<tr class="odd">
<td align="left">sources</td>
<td align="left">4</td>
<td align="left">sf</td>
<td align="left">list</td>
</tr>
<tr class="even">
<td align="left">targets</td>
<td align="left">5</td>
<td align="left">data.frame</td>
<td align="left">list</td>
</tr>
</tbody>
</table>
</div>
<div id="testdata---spatial-data" class="section level3">
<h3 class="hasAnchor">
<a href="#testdata---spatial-data" class="anchor"></a>testdata - spatial data</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co"># A preview of the data included in the package</span>
<span class="co"># create pnt_sf using the included x, y coordinates, EPSG:4326</span>
<span class="co"># needs to be projected to EPSG:3035 for plotting</span>
<span class="va">targets_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">targets</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fl">3035</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co"># 500m polygon grid for aggregation purposes, EPSG:3035 </span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span><span class="op">$</span><span class="va">geometry</span>, border <span class="op">=</span> <span class="st">"darkgrey"</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># source point data, n = 200, EPSG:4326</span>
<span class="co"># needs to be projected to EPSG:3035 for plotting</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">sources</span>, <span class="fl">3035</span><span class="op">)</span><span class="op">$</span><span class="va">geom</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># target point data, n = 163</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">targets_sf</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">.8</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction%20to%20odmind_files/figure-html/unnamed-chunk-3-1.png" width="624" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="step-1---create-an-odm-object" class="section level2">
<h2 class="hasAnchor">
<a href="#step-1---create-an-odm-object" class="anchor"></a>Step 1 - Create an odm-object</h2>
<p>All functions with the suffix <code>create_</code> work with an odm-object which is of type <code>list</code> and contains a <code>numeric matrix</code> for <em>distance</em> and <em>duration</em> as well as the input data that was used to calculate the matrices. The sources are a <code>sf</code> of geometry type <code>POINT</code> and the targets a <code>data.frame</code>.</p>
<p>To make full use of all package functions the sources and targets need to follow at least the following data structures. Additional columns with further attributes can be included in the sources and targets if needed. Coordinates need to be supplied in <code>EPSG:4326</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">sources</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">source_id</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="left">geom</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">6.977482</td>
<td align="right">51.42968</td>
<td align="left">POINT (6.977482 51.42968)</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6.990986</td>
<td align="right">51.43171</td>
<td align="left">POINT (6.990986 51.43171)</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7.037876</td>
<td align="right">51.45258</td>
<td align="left">POINT (7.037876 51.45258)</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">6.978143</td>
<td align="right">51.44346</td>
<td align="left">POINT (6.978143 51.44346)</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">7.050361</td>
<td align="right">51.44739</td>
<td align="left">POINT (7.050361 51.44739)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">targets</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">target_id</th>
<th align="left">name</th>
<th align="left">category</th>
<th align="right">x</th>
<th align="right">y</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">amenity_1</td>
<td align="left">A</td>
<td align="right">7.02393</td>
<td align="right">51.45057</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">amenity_2</td>
<td align="left">B</td>
<td align="right">6.98052</td>
<td align="right">51.41443</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">amenity_3</td>
<td align="left">C</td>
<td align="right">7.00386</td>
<td align="right">51.45200</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">amenity_4</td>
<td align="left">A</td>
<td align="right">7.00992</td>
<td align="right">51.46822</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">amenity_5</td>
<td align="left">B</td>
<td align="right">6.98880</td>
<td align="right">51.43774</td>
</tr>
</tbody>
</table>
<div id="execute-calculaton" class="section level3">
<h3 class="hasAnchor">
<a href="#execute-calculaton" class="anchor"></a>Execute calculaton</h3>
<p>An odm-object can be created sequentially by using</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>openrouteservice.url <span class="op">=</span> <span class="st">"PUT YOUR URL HERE"</span><span class="op">)</span>
<span class="va">odm_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_odm.html">calc_odm</a></span><span class="op">(</span>profile_string <span class="op">=</span> <span class="st">"foot-walking"</span>,
                       source_locations <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">sources</span>,
                       target_locations <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">targets</span>,
                       max_chunk_size <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
<p>or in parallel by using</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu">doSNOW</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doSNOW/man/registerDoSNOW.html">registerDoSNOW</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>
<span class="va">odm_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_odm_multicore.html">calc_odm_multicore</a></span><span class="op">(</span>profile_string <span class="op">=</span> <span class="st">"foot-walking"</span>,
                          source_locations <span class="op">=</span> <span class="va">sources</span>,
                          target_locations <span class="op">=</span> <span class="va">targets</span>,
                          max_chunk_size <span class="op">=</span> <span class="fl">200</span>,
                          ors_url <span class="op">=</span> <span class="st">"PUT YOUR URL HERE"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="step-2---calculate-accessibility-indicators" class="section level2">
<h2 class="hasAnchor">
<a href="#step-2---calculate-accessibility-indicators" class="anchor"></a>Step 2 - Calculate accessibility indicators</h2>
<p>Once you have created a odm-list-object calculating indicators is straight forward. The following functions are provided:</p>
<table class="table">
<colgroup>
<col width="19%">
<col width="21%">
<col width="41%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="left">function</th>
<th align="left">arguments</th>
<th align="left">short description</th>
<th align="center">output</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/create_time_distance_sf.html">create_time_distance_sf()</a></code></td>
<td align="left"><code>odm-object</code></td>
<td align="left">Calculates distance in meters and duration in minutes from all source points to the closest target location</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/create_time_distance_n_sf.html">create_time_distance_n_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, n</td>
<td align="left">Calculates distance in meters and duration in minutes from all source points to n closest target locations</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/create_time_distance_by_cat_sf.html">create_time_distance_by_cat_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, filter_attribute, filter_value</td>
<td align="left">Calculates distance in meters and duration in minutes from all source points to the closest target location of a chosen category</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/create_time_distance_n_by_cat_sf.html">create_time_distance_n_by_cat_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, filter_attribute, filter_value, n</td>
<td align="left">Calculates distance in meters and duration in minutes from all source points to n closest target locations of a chosen category</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/create_cumulative_sf.html">create_cumulative_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, filter_value_type, accessibility_filter_value, search_direction</td>
<td align="left">All locations which are accessible within the applied time or distance threshold are counted. The count can be calculated in either direction (source to target or target to source)</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/create_cumulative_by_cat_sf.html">create_cumulative_by_cat_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, filter_value_type, accessibility_filter_value, search_direction, filter_attribute, filter_value</td>
<td align="left">All locations which belong to a chosen category and are accessible within the applied time or distance threshold are counted. The count can be calculated in both directions (source to target or target to source)</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/create_potential_sf.html">create_potential_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, filter_value_type, accessibility_filter_value, search_direction, ors_profile</td>
<td align="left">A decay function is applied to all locations which are accessible within the defined time or distance threshold. The function models a location potential respecting the spatial distribution. Thus, closer features result in higher values. It can be calculated in either direction (source to target or target to source)</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/create_potential_by_cat_sf.html">create_potential_by_cat_sf()</a></code></td>
<td align="left">
<code>odm-object</code>, filter_value_type, accessibility_filter_value, search_direction, ors_profile, filter_attribute, filter_value</td>
<td align="left">A decay function is applied to all locations which belong to a chosen category and are accessible within the defined time or distance threshold. The function models a location potential respecting the spatial distribution. Thus, closer features result in higher values. It can be calculated in either direction (source to target or target to source)</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
</tbody>
</table>
<p>The following example shows the calculation of the distance and duration to the nearest target location using the provided dataset:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_time_distance_sf.html">create_time_distance_sf</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Min_Dist could be switched to Min_Time</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="st">"Min_Dist"</span><span class="op">]</span>, key.pos <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction%20to%20odmind_files/figure-html/unnamed-chunk-7-1.png" width="624" style="display: block; margin: auto;"></p>
<hr>
<p>This is only the most basic example but the other listed functions work in a similar way. You just need to add further function parameters.</p>
</div>
<div id="step-3---aggregate-an-indicator-to-an-area-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#step-3---aggregate-an-indicator-to-an-area-of-interest" class="anchor"></a>Step 3 - Aggregate an indicator to an area of interest</h2>
<p>Once you have calculated one or more <strong>accessibility indicators</strong> you might want to aggregate those to statistical spatial units or regular grids. For this use case corresponding aggregation functions are provided:</p>
<table class="table">
<colgroup>
<col width="19%">
<col width="21%">
<col width="41%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="left">function</th>
<th align="left">arguments</th>
<th align="left">short description</th>
<th align="center">output</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/aggregate_expenses.html">aggregate_expenses()</a></code></td>
<td align="left">aoi_sf, pnt_sf, id_col, crs</td>
<td align="left">Aggregate the <code>sf</code> (geometry type <code>POINT</code>) attributes <em>Min_Dist</em> and <em>Min_Time</em> to an area of interest</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/aggregate_accumulation.html">aggregate_accumulation()</a></code></td>
<td align="left">aoi_sf, pnt_sf, id_col, crs</td>
<td align="left">Aggregate the <code>sf</code> (geometry type <code>POINT</code>) attribute <em>MeanCnt</em> or <em>MedianCnt</em> to an area of interest</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/aggregate_potential.html">aggregate_potential()</a></code></td>
<td align="left">aoi_sf, pnt_sf, id_col, crs</td>
<td align="left">Aggregate the <code>sf</code> (geometry type <code>POINT</code>) attributes <em>MeanPot</em> and <em>MedianPot</em> to an area of interest</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/aggregate_coverage_rate_by_threshold.html">aggregate_coverage_rate_by_threshold()</a></code></td>
<td align="left">aoi_sf, pnt_sf, id_col, crs</td>
<td align="left">Calculate an average coverage rate within an area of interest by applying a threshold filter to one of the <code>sf</code> (geometry type <code>POINT</code>) attributes <em>Min_Dist</em> or <em>Min_Time</em>. A source location is defined as covered if a target location is accessible within the threshold distance or time.</td>
<td align="center">
<code>sf</code> geometry type <code>POINT</code>
</td>
</tr>
</tbody>
</table>
<p>The following example shows the aggregation and visualization of the minimum distance and duration values calculated in <em>step 2</em>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">min_dist_time_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_time_distance_sf.html">create_time_distance_sf</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fl">4647</span><span class="op">)</span>
<span class="co"># Add targets for plotting</span>
<span class="va">targets_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">$</span><span class="va">targets</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_set_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fl">4647</span><span class="op">)</span>
<span class="va">result_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_expenses.html">aggregate_expenses</a></span><span class="op">(</span>aoi_sf <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span>,
                                pnt_sf <span class="op">=</span> <span class="va">min_dist_time_sf</span>,
                                id_col <span class="op">=</span> <span class="st">"id"</span>,
                                crs <span class="op">=</span> <span class="fl">4647</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co"># MedianDist could be switched to MedianTime</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">result_sf</span><span class="op">[</span><span class="st">"MedianDist"</span><span class="op">]</span>, border <span class="op">=</span> <span class="st">"darkgrey"</span>, key.pos <span class="op">=</span> <span class="fl">1</span>, reset <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">min_dist_time_sf</span><span class="op">$</span><span class="va">geom</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">targets_sf</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">.8</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction%20to%20odmind_files/figure-html/unnamed-chunk-8-1.png" width="624" style="display: block; margin: auto;"></p>
<hr>
<p>This is only one example but the other listed functions work in a similar way. You just need to provide the respective accessibility indicator result to the aggregation function.</p>
</div>
<div id="step-4---merge-multiple-aggregated-indicator-results-optional" class="section level2">
<h2 class="hasAnchor">
<a href="#step-4---merge-multiple-aggregated-indicator-results-optional" class="anchor"></a>Step 4 - Merge multiple aggregated indicator results <em>(optional)</em>
</h2>
<p>For convenience a merge function is provided which allows you to easily combine the <code>sf</code> objects of multiple <strong>aggregated indicators</strong> which have been aggregated to the same areas of interest.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Travel expenses</span>
<span class="va">min_dist_time_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_time_distance_sf.html">create_time_distance_sf</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span><span class="op">)</span> 
<span class="va">expenses_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_expenses.html">aggregate_expenses</a></span><span class="op">(</span>aoi_sf <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span>,
                                  pnt_sf <span class="op">=</span> <span class="va">min_dist_time_sf</span>,
                                  id_col <span class="op">=</span> <span class="st">"id"</span>,
                                  crs <span class="op">=</span> <span class="fl">4647</span><span class="op">)</span>
<span class="co"># Accumulation </span>
<span class="va">cnt_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_cumulative_sf.html">create_cumulative_sf</a></span><span class="op">(</span>odm_object <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span>,
                               filter_value_type <span class="op">=</span> <span class="st">"distance"</span>,
                               accessibility_filter_value <span class="op">=</span> <span class="fl">750</span>,
                               search_direction <span class="op">=</span> <span class="st">"to_target"</span><span class="op">)</span>
<span class="va">cumulative_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_accumulation.html">aggregate_accumulation</a></span><span class="op">(</span>aoi_sf <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span>,
                                        pnt_sf <span class="op">=</span> <span class="va">cnt_sf</span>,
                                        id_col <span class="op">=</span> <span class="st">"id"</span>,
                                        crs <span class="op">=</span> <span class="fl">4647</span><span class="op">)</span>
<span class="co"># Potential</span>
<span class="va">pot_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_potential_sf.html">create_potential_sf</a></span><span class="op">(</span>odm_object <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">od_result</span>,
                              filter_value_type <span class="op">=</span> <span class="st">"distance"</span>,
                              accessibility_filter_value <span class="op">=</span> <span class="fl">750</span>,
                              search_direction <span class="op">=</span> <span class="st">"to_target"</span>,
                              ors_profile <span class="op">=</span> <span class="st">"foot-walking"</span><span class="op">)</span>
<span class="va">potential_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_potential.html">aggregate_potential</a></span><span class="op">(</span>aoi_sf <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span>,
                                    pnt_sf <span class="op">=</span> <span class="va">pot_sf</span>,
                                    id_col <span class="op">=</span> <span class="st">"id"</span>,
                                    crs <span class="op">=</span> <span class="fl">4647</span><span class="op">)</span>
<span class="co"># Coverage rate in %</span>
<span class="va">coverage_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_coverage_rate_by_threshold.html">aggregate_coverage_rate_by_threshold</a></span><span class="op">(</span>aoi_sf <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span>,
                                                    pnt_sf <span class="op">=</span> <span class="va">min_dist_time_sf</span>,
                                                    id_col <span class="op">=</span> <span class="st">"id"</span>,
                                                    threshold_col <span class="op">=</span> <span class="st">"Min_Dist"</span>,
                                                    threshold_value <span class="op">=</span> <span class="fl">350</span>,
                                                    crs <span class="op">=</span> <span class="fl">4647</span><span class="op">)</span>
<span class="co"># Merge </span>
<span class="va">merged_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_indicators.html">merge_indicators</a></span><span class="op">(</span>aoi_sf <span class="op">=</span> <span class="va">testdata</span><span class="op">$</span><span class="va">grid_500m</span>, id_col <span class="op">=</span> <span class="st">"id"</span>,
                              <span class="va">expenses_sf</span>, <span class="va">cumulative_sf</span>, <span class="va">potential_sf</span>,
                              <span class="va">coverage_sf</span><span class="op">)</span>
<span class="co"># Remove the the geometry column just for table presentation</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">merged_sf</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="right">MedianDist</th>
<th align="right">MedianTime</th>
<th align="right">MeanCnt</th>
<th align="right">MedianCnt</th>
<th align="right">MeanPot</th>
<th align="right">MedianPot</th>
<th align="right">Mean_CoverageRate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">383.160</td>
<td align="right">4.597750</td>
<td align="right">2.5</td>
<td align="right">2.5</td>
<td align="right">218.80910</td>
<td align="right">218.20230</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">698.425</td>
<td align="right">8.380833</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">75.13072</td>
<td align="right">75.13072</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">607.235</td>
<td align="right">7.286667</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">50.00000</td>
<td align="right">50.00000</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">334.500</td>
<td align="right">4.013833</td>
<td align="right">8.0</td>
<td align="right">8.0</td>
<td align="right">683.06632</td>
<td align="right">683.06632</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">198.420</td>
<td align="right">2.380833</td>
<td align="right">7.8</td>
<td align="right">7.0</td>
<td align="right">714.32792</td>
<td align="right">647.56115</td>
<td align="right">80</td>
</tr>
</tbody>
</table>
<p>This last example gives a concluding first impression of the functions provided within package. See <code>?odmind</code> for more details!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marcel Schonlau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
